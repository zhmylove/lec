% Made by: KorG
% vim: ft=tex cc=79 ts=3 sw=3 et
\documentclass[hyperref={unicode=true}]{beamer}
\usepackage[T2A]{fontenc}       % fonts
\usepackage[utf8]{inputenc}     % UTF-8
\usepackage[english,russian]{babel}     % russian
\usepackage{cmap}               % russian search in pdf
\usepackage{droid}              % Droid font
\usepackage{float}              % essential for [H]
\usepackage{indentfirst}        % first string indention
\usepackage{graphicx}           % graphics
\usepackage{ltxtable}           % tables
\usepackage{amsmath}            % math
\usepackage{nccmath}            % math
\usepackage{amsfonts}           % math fonts
\usepackage{amssymb}            % math symb
\usepackage{color}
\usepackage{xcolor}
\definecolor{light-gray}{gray}{0.9}
\usepackage{multirow}
\usepackage{tabularx}
\usepackage{placeins}
\usepackage{totcount}
\usepackage{soul}               % \so{} & \ul{} - source and underline
\usepackage{soulutf8}           % UTF-8 for soul
\usepackage{verbatim}           % \verb{} and verbatim environment
\usepackage{listings}           % source code `bl
\usepackage{totcount}
\usepackage{pbox}
\usepackage{rotating}
\usepackage{makecell} %TODO add to the preambule
\lstset{
   escapeinside={\#@}{@},
   extendedchars=\true,
   numbers=none,
   inputencoding=utf8,
   keepspaces=true,
   basicstyle=\large\ttfamily,
   backgroundcolor=\color{light-gray},
   tabsize=3,
   breaklines=true,
   postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{
      \color{red}\hookrightarrow\space}
   }
}

\usebackgroundtemplate{
   \begin{picture}(0,260)
      \minipage{0.9\textwidth}
      
      {\if\LANG3
      	\includegraphics[width=0.6\textwidth]{ifmo_ru.jpg}
      \fi }
      {\if\LANG2
      	\includegraphics[width=0.6\textwidth]{ifmo_en.jpg}
      \fi }
      
      \endminipage
      \hfill \hspace*{60px}
      \ifnum\value{framenumber}>1 \Large \insertpagenumber \fi
   \end{picture}
}

\setbeamertemplate{navigation symbols}{}

\selectlanguage{english}
%\selectlanguage{russian} % ? comment out?

\makeatletter
\ifnum\pdf@strcmp{\jobname}{presRUS}=0 \def\LANG{3} \else \def\LANG{2} \fi
\makeatother

\newcommand{\Rus}[1]{\if\LANG3
#1
\fi }
\newcommand{\Eng}[1]{\if\LANG2
#1
\fi }


\Eng{
\title{\LARGE Lecture materials \\ on system \\
   software development \vspace{2em}}
\author{Zhmylev Sergei \vspace{-1em}}
\date{Autumn 2019}
}
\Rus{
\title{\LARGE Материалы к лекциям \\ по основам \\
   системного программирования \vspace{2em}}
\author{Жмылёв Сергей Александрович \vspace{-1em}}
\date{Осень 2019}
}

\begin{document} \Large

\begin{frame} \titlepage \end{frame}

\regtotcounter{section}
\setbeamertemplate{section in toc}{\inserttocsection}
\setbeamercolor{section in toc}{fg=black}
\begin{frame}[allowframebreaks]{\Rus{Структура курса}\Eng{Course structure}}
\fontsize{1em}{-1em}\selectfont
\vspace{1em} \tableofcontents[sections=1-8] \vspace{2em}
\ifnum\totvalue{section}>8 \framebreak
\vspace{1em} \tableofcontents[sections=9-16]  \vspace{2em} \fi
\ifnum\totvalue{section}>16 \framebreak
\vspace{1em} \tableofcontents[sections=17-24] \vspace{2em} \fi
\ifnum\totvalue{section}>24 \framebreak
\vspace{1em} \tableofcontents[sections=25-32] \vspace{2em} \fi
\ifnum\totvalue{section}>32 \framebreak
\vspace{1em} \tableofcontents[sections=33-40] \vspace{2em} \fi
\ifnum\totvalue{section}>40 \framebreak
\vspace{1em} \tableofcontents[sections=41-48] \vspace{2em} \fi
\ifnum\totvalue{section}>48 \framebreak
\vspace{1em} \tableofcontents[sections=49-56] \vspace{2em} \fi
\ifnum\totvalue{section}>56 \framebreak
\vspace{1em} \tableofcontents[sections=57-64] \vspace{2em} \fi
\ifnum\totvalue{section}>64 \framebreak
\vspace{1em} \tableofcontents[sections=65-72] \vspace{2em} \fi
\ifnum\totvalue{section}>72 \framebreak
\vspace{1em} \tableofcontents[sections=73-80] \vspace{2em} \fi
\ifnum\totvalue{section}>80 \framebreak
\vspace{1em} \tableofcontents[sections=81-88] \vspace{2em} \fi
\ifnum\totvalue{section}>88 \framebreak
\vspace{1em} \tableofcontents[sections=89-96] \vspace{2em} \fi
\ifnum\totvalue{section}>96 \framebreak
\vspace{1em} \tableofcontents[sections=97-104] \vspace{2em} \fi
\end{frame}

\newcommand{\iframe}[1]{
\section{#1}\begin{frame}[fragile]{#1}\par\vspace{-1em}
}
\newcommand{\pframe}[1]{
\begin{frame}[fragile]{#1}\par\vspace{-1em}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\pframe{\Rus{Полезные ссылки}\Eng{Useful links}}
   \url{http://src.illumos.org/}

   \begin{large}
      \begin{center}
         \url{https://github.com/mit-pdos/xv6-public}
      \end{center}
   \end{large}

   \vspace{1em} \url{https://se.ifmo.ru/~korg/} \\
   \vspace{1em} \url{https://vk.com/korglings} \\
   \vspace{1em} \Rus{Литература}\Eng{Books}:
   \begin{enumerate}
      \item Uresh Vahalia. UNIX Internals
      \item A.~S.~Tanenbaum, A.~S.~Woodhull. Operating Systems: Design and Implementation
   \end{enumerate}
\end{frame}

\iframe{\Rus{Системное программное обеспечение}\Eng{System software}}
\begin{itemize}
   \setlength\itemsep{2em}
      \item \Rus{Языки СПО}\Eng{System software languages}
      \item \Rus{Системные вызовы}\Eng{Syscalls}
      \item \Rus{Ввод-вывод}\Eng{I/O}
      \item \Rus{Потоки и процессы}\Eng{Threads and processes}
   \end{itemize}
\end{frame}

\iframe{\Rus{Программный интерфейс}\Eng{Software interface}}
   \begin{center}
      \Rus{Любая программа принимает аргументы и}\Eng{Each program receives arguments and}
      \Rus{переменные окружения}\Eng{environment variables}
   \end{center}
   \vspace{1cm} \Rus{Код возврата – число, отображающее}\Eng{Error code is an integer describing the}
   \Rus{корректность завершения}\Eng{correctness of program termination}
\end{frame}

\iframe{\Rus{Структура программ}\Eng{Code structure}}
\begin{lstlisting}
int main(
   int argc,
   char *argv[],
   #@\textcolor{gray}{char *envp[]} @
) {
   /* ... */

   return 0;
}
\end{lstlisting}
\end{frame}

\pframe{\Rus{Структура программ}\Eng{Code structure}} 
\begin{lstlisting}
#include <stdlib.h>

int main(
   int argc,
   char *argv[],
   #@\textcolor{gray}{char *envp[]} @
) {
   /* ... */

   return EXIT_SUCCES;
}
\end{lstlisting}
\end{frame}

\iframe{\Rus{Компиляция программ}\Eng{Code compilation}} 
\begin{lstlisting}
# gcc -c program.c
# gcc -o program program.o

# gcc -o program program.c

# cc -o program program.c
\end{lstlisting}
\end{frame}

\iframe{\Rus{Код возврата}\Eng{Error code}}
\begin{lstlisting}
# rm -f /etc/passwd 2<&-
# echo $?
1
# echo Hello, world!
Hello, world!
# echo $?
0
\end{lstlisting}
\end{frame}

\pframe{\Rus{Популярная ошибка}\Eng{A popular mistake}}
   \begin{center}
      \Rus{Использование void main() - недопустимо!}\Eng{Using void main() is inappropriate!}
   \end{center}
   \lstinputlisting[language=C]{listings/e2.c}
\end{frame}

\iframe{\Rus{Роль системы}\Eng{A role of the OS}}
   \begin{itemize}
   \setlength\itemsep{1em}
      \item \Rus{Многозадачность;}\Eng{Multitasking;}
      \item \Rus{Виртуализация памяти;}\Eng{Memory virtualization;}
      \item \Rus{Управление устройствами;}\Eng{Device management;}
      \item \Rus{Обработка прерываний;}\Eng{Interrupt handling;}
      \item \Rus{Расширение набора операций, доступных программам.}\Eng{Extending the available set of application-level operations.}
   \end{itemize}
\end{frame}

\iframe{\Rus{Загрузка системы}\Eng{OS booting process}}
   \begin{itemize}
   \setlength\itemsep{0.8em}
      \item Reset vector: UEFI, BIOS, \dots
      \item I/O, *PIC(IRQ), VGA
      \item POST + PCI BIOS
      \item \Rus{Выбор загрузочного устройства}\Eng{Boot device detection}
      \item \Rus{Загрузчик stage0 (boot sector)}\Eng{Bootloader stage0 (boot sector)}
      \item \Rus{Загрузчик stage1}\Eng{Bootloader stage1}
      \item \Rus{Ядро ОС}\Eng{OS kernel}
   \end{itemize}
\end{frame}

\iframe{\Rus{Системные вызовы}\Eng{Syscalls}}
   \begin{itemize}
   \setlength\itemsep{1em}
      \item \Rus{Обращение к функции ядра системы}\Eng{Kernel functions calling}
      \item \Rus{Использование аппаратного обеспечения через единый API}\Eng{Using hardware via the common API}
      \item \Rus{Имеют интерфейс libc}\Eng{Have libc interfaces}
      \item \Rus{Имеют привилегии ядра операционной системы}\Eng{Have kernel privileges}
   \end{itemize}
\end{frame}

\iframe{\Rus{Обращение к системе}\Eng{Calling the OS}}
   \Rus{\lstinputlisting[language=C]{listings/e3rus.c}}\Eng{\lstinputlisting[language=C]{listings/e3eng.c}}

   \lstinputlisting[language=C]{listings/e4.c}

   \begin{lstlisting}
# cc -m64 -Wall -Wextra -Wno-comment \
   -nostdlib -o main main.S \end{lstlisting} % =(

   \begin{center}
      \url{https://pastebin.com/knTdpZRe}
   \end{center}
\end{frame}

\iframe{\Rus{Файл}\Eng{File}}
   \begin{center}
      \Rus{Что такое файл?}\Eng{What is a file?}
   \end{center}
   \vspace{2cm} Everything is a file!

   \textit{\Rus{Кроме потоков и ядра}\Eng{Apart from threads and the kernel}}
\end{frame}

\iframe{\Rus{Дескриптор файла}\Eng{File descriptor}}
   \begin{normalsize}
      \url{http://src.illumos.org/source/xref/illumos-gate/usr/src/uts/common/syscall/open.c#54} \\
      \vspace{1em} \url{http://src.illumos.org/source/xref/illumos-gate/usr/src/uts/common/fs/vnode.c#940}
   \end{normalsize}
   \begin{itemize}
      \item \Rus{Номер файлового дескриптора -- целое неотрицательное число, абстрагирующее процессы от файлов, с которыми они работают.}\Eng{A file descriptor number is a positive integer that abstracts processes from files they are using.}
   \end{itemize}
\end{frame}

\iframe{\Rus{Потоки ввода-вывода процесса}\Eng{I/O streams of a process}}
   \begin{table}[H]
      \centering
      \begin{tabular}{|c|c|c|}
         \hline
         \textbf{\Rus{Номер}\Eng{Number}} & \textbf{\Rus{Файл}\Eng{File}} & \textbf{\Rus{Флаги}\Eng{Flags}} \\
         \hline 0 & /dev/tty & \makecell{O\_RDWR | \\ O\_LARGEFILE} \\ 
         \hline 1 & /dev/tty & \makecell{O\_RDWR | \\ O\_LARGEFILE} \\ 
         \hline 2 & /dev/tty & \makecell{O\_RDWR | \\ O\_LARGEFILE} \\ 
         \hline 3 & /etc/passwd & O\_RDONLY \\
         \hline 4 & /dev/mtdblock3 & O\_RDWR \\
         \hline ... & ... & ... \\
         \hline 255 & ... & ... \\
         \hline
      \end{tabular}
   \end{table}
\end{frame}

\iframe{\Rus{Стандартные потоки ввода-вывода}\Eng{Standard I/O streams}}
   \lstinputlisting[language=C]{listings/e5.c}
\end{frame}

\iframe{ open(2)}
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/open.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/open.ru.c}}

   \vspace{1em} \Rus{Функция возвращает номер дескриптора или код ошибки}\Eng{Returns a file descriptor number or an error code}
\end{frame}

\iframe{\Rus{Основные режимы доступа}\Eng{Common access modes}}
   \begin{itemize}
   \setlength\itemsep{0.6em}
      \item[] O\_RDONLY -- \Rus{только для чтения}\Eng{Read-only}
      \item[] O\_WRONLY -- \Rus{только для записи}\Eng{Write-only}
      \item[] O\_RDWR -- \Rus{для записи/чтения}\Eng{Read-write}
      \item[] O\_CREAT -- \Rus{создать, если не существует}\Eng{Create if not exists}
      \item[] O\_APPEND -- \Rus{запись с конца}\Eng{Append to the end of the file}
      \item[] O\_TRUNC -- \Rus{запись с начала}\Eng{Write from the beginning of the file}
      \item[] O\_LARGEFILE -- \Rus{длинная позиция в файле}\Eng{Long file position}
      \item[] O\_EXCL -- \Rus{длинная позиция в файле}\Eng{Long file position}
   \end{itemize}
\end{frame}

\iframe{ lseek(2)} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/lseek.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/lseek.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает полученное смещение в байтах или код ошибки}\Eng{Returns an updated offset in bytes or an error code}
\end{frame}

\iframe{ read(2)} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/read.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/read.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает количество прочитанных байт или код ошибки}\Eng{Returns the amount of bytes read successfully or an error code}
\end{frame}

\iframe{ write(2)} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/write.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/write.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает количество записанных байт или код ошибки}\Eng{Returns the amount of bytes written successfully or an error code}
\end{frame}

\iframe{ close(2)} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/close.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/close.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{ dup(2)\Rus{и}\Eng{and} dup2(2)} 

\Eng{\lstinputlisting[language=C]{listings/syscallexamples/dup.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/dup.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает номер нового дескриптора или код ошибки}\Eng{Returns a number of a new file descriptor or an error code}
\end{frame}

\iframe{ stat(2)} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/stat.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/stat.ru.c}}
   
   \vspace{1em} \Rus{Функция возвращает номер 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Ошибки в системных вызовах}\Eng{Errors in syscalls}}
   \begin{itemize}
   \setlength\itemsep{1em}
      \item[] \Rus{Код возврата системного вызова:}\Eng{A return code of the syscall:}
      \item \Rus{меньше 0 -- ошибка в ходе выполнения вызова}\Eng{below zero -- an error occured while syscall processing}
      \item \Rus{равен 0 -- успешное выполнение}\Eng{equals to zero -- successful execution of the syscall}
      \item \Rus{больше 0 -- результат успешного выполнения}\Eng{above zero - the result of the successful exection}
   \end{itemize}
\end{frame}

\iframe{\Rus{Стандартизация ошибок}\Eng{Error code standardization}}
   \begin{itemize}
   \setlength\itemsep{1em}
      \item \Rus{Унификация ошибочных кодов}\Eng{Error code unification}
      \item \Rus{Переменная }\lstinline{errno}\Eng{variable}
      \item \Rus{Функция }\lstinline{perror(3)}\Eng{function}
      \item \Rus{Функция }\lstinline{strerror(3)}\Eng{function}
   \end{itemize}
\end{frame}

\iframe{\Rus{Пример ошибки}\Eng{Error example}} 
   \lstinputlisting[language=C]{listings/sl28.c}
\end{frame}

\iframe{\Rus{Заголовочные файлы}\Eng{Headers}} 
   \begin{itemize}
   \setlength\itemsep{1em}
      \item unistd.h -- \Rus{объявления UNIX}\Eng{UNIX declarations}
      \item stdio.h -- \Rus{стандартный ввод/вывод}\Eng{standard input/output}
      \item fcntl.h -- \Rus{операции с файлами}\Eng{file operations} 
      \item sys/types.h -- \Rus{системные типы}\Eng{system types}
      \item sys/stat.h -- \Rus{системные статусы}\Eng{system statuses}
   \end{itemize}
\end{frame}

\iframe{\Rus{Пример чтения/записи}\Eng{Read/write example}} 
   \lstinputlisting[language=C]{listings/sl30.c}
\end{frame}

\iframe{ Makefile} 
   \lstinputlisting[language=C]{listings/sl31.c}
\end{frame}

\iframe{\Rus{Утилита make}\Eng{make utility}}  
   \lstinputlisting[language=C]{listings/sl32.c}
\end{frame}

\iframe{\Rus{Полезные функции}\Eng{Useful functions}} 
\begin{itemize}
	\item isatty(3C) 
	\item gethostbyname(3NSL) 
	\item[]gethostbyaddr(3NSL) 
	\item htons(3SOCKET) 
	\item[]htonl(3SOCKET) 
	\item[]ntohs(3SOCKET) 
	\item[]ntohl(3SOCKET) 
	\item usleep(3C) 
\end{itemize}
\end{frame}

\iframe{\Rus{Ввод-вывод со смещением}\Eng{I/O with offsets}} 
   \lstinputlisting[language=C]{listings/sl33.c}
   \vspace{1em} \Rus{Функции возвращают количество байт или код ошибки}\Eng{Returns the amount of bytes or an error code}
\end{frame}

\iframe{\Rus{Рассеянный ввод-вывод}\Eng{Useful functions}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/readv.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/readv.ru.c}}

   \vspace{1em} \Rus{Функция возвращает количество байт или код ошибки}\Eng{Returns the amount of bytes or an error code}
\end{frame}

\iframe{\Rus{Структура iovec (I/O vector)}\Eng{iovec structure (I/O vector)}} 
   \lstinputlisting[language=C]{listings/sl35.c}
\end{frame}

\iframe{\Rus{Сброс кешей}\Eng{Cache flushing}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/sync.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/sync.ru.c}}

   \vspace{1em} \Rus{Код возврата функции не информативен}\Eng{Return code is meaningless}
\end{frame}

\iframe{\Rus{Работа с файловыми дескрипторами}\Eng{Working with file descriptors}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/fcntl.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/fcntl.ru.c}}

   \vspace{1em} \Rus{Код возврата функции интерпретируется в зависимости от команды}\Eng{Return code meaning depends on a particular command}
\end{frame}

\iframe{\Rus{Команды }fcntl(2)\Eng{commands}} 
   F\_DUPFD / F\_DUP2FD \hfill \Rus{аналог}\Eng{similar to} dup/dup2 \\
   F\_FREESP \hfill \Rus{освободить место}\Eng{free up some space} \\
   F\_GETFD / F\_SETFD \hfill \Rus{флаг }close on exec\Eng{ flag} \\
   F\_GETFL / F\_SETFL \hfill \Rus{флаги доступа}\Eng{access flags} \\
   \vspace{1em} F\_GETLK / F\_SETLK \hfill \Rus{блокировка файла}\Eng{file locking} \\
   F\_GETLKW / F\_SETLKW \hfill

   \begin{center} \vspace{1em} F\_RDLCK / F\_WRLCK / F\_UNLCK \end{center}
\end{frame}	

\iframe{\Rus{Проверка доступа}\Eng{Access rights check}}
   \begin{lstlisting}
int access(const char *path, int amode); \end{lstlisting}

   R\_OK – \Rus{чтение}\Eng{read} \\
   W\_OK – \Rus{запись}\Eng{write} \\
   X\_OK – \Rus{исполнение}\Eng{execute} \\
   F\_OK – \Rus{существование}\Eng{existence}

   \vspace{1em} \Rus{Функция возвращает 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Изменение прав доступа}\Eng{Access rights modification}} 
   \begin{lstlisting}
int chmod(const char *path, mode_t mode); 
int fchmod(int fildes, mode_t mode); \end{lstlisting}

   S\_ISUID 04000 \\
   S\_IRWXU 00700 \\
   (S\_ISUID | S\_URWXU) 04700 

   \vspace{1em} \Rus{Функции возвращают 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Изменение владельца}\Eng{Changing file owner}}
   \begin{lstlisting}
int chown(
   const char *path,
   uid_t owner,
   gid_t group
); 
int fchown(
   int fildes,
   uid_t owner,
   gid_t group
); \end{lstlisting}

   \vspace{1em} \Rus{Функции возвращают 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Маска создания файла}\Eng{File creation mask}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/umask.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/umask.ru.c}}

   \vspace{1em} \Rus{Возвращает предыдущее значение маски}\Eng{Returns the previous mask value} 

   \begin{center} \vspace{1em} \Rus{Как получить текущее значение?}\Eng{How should you get the current value?} \end{center}
\end{frame}

\iframe{\Rus{Работа с ссылками}\Eng{Working with links}}
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/link.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/link.ru.c}}

   \vspace{1em} \Rus{Функции возвращают 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Символьные ссылки}\Eng{Symbolic links}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/symlink.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/symlink.ru.c}}
\end{frame}

\iframe{\Rus{Работа с каталогами}\Eng{Working with directories}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/mkdir.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/mkdir.ru.c}}
   \vspace{1em} \Rus{Функции возвращают 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Рабочая директория}\Eng{Current working directory}} 
   \begin{lstlisting}
int chdir(const char *path); 
int fchdir(int fildes); \end{lstlisting}

	\vspace{1em} \lstinline{getcwd(3)} \Rus{возвращает указатель на буфер
либо -1 и имеет прототип:}\Eng{returns either a pointer to a buffer or a -1;
has the following prototype}

   \begin{lstlisting}
char *getcwd(char *buf, size_t size); 
   \end{lstlisting}
\end{frame}

\iframe{\Rus{Чтение каталогов}\Eng{Reading directory}} 
\begin{lstlisting}
   DIR *opendir(const char *dirname); 

   struct dirent *readdir(DIR *dirp); 
   
   void rewinddir(DIR *dirp); 
   
   int closedir(DIR *dirp); 
\end{lstlisting}
\end{frame}

\iframe{\Rus{Структура dirent}\Eng{dirent structure}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/dirent.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/dirent.ru.c}}
\end{frame}

\iframe{\Rus{Файлы устройств}\Eng{Device files}} 
\Eng{\lstinputlisting[language=C]{listings/syscallexamples/mknod.en.c}}
\Rus{\lstinputlisting[language=C]{listings/syscallexamples/mknod.ru.c}}

   \vspace{1em} \Rus{Функции возвращают 0 или код ошибки}\Eng{Returns zero or an error code}
\end{frame}

\iframe{\Rus{Модель памяти процесса}\Eng{Memory model of a process}} 
\begin{center}
	
	{\if\LANG3
		\includegraphics[width=0.99\textwidth]{img/mem_model_ru.pdf}
	\fi }
	{\if\LANG2
		\includegraphics[width=0.99\textwidth]{img/mem_model_en.pdf}
	\fi }

\end{center}       
\end{frame}

\iframe{\Rus{Выделение памяти}\Eng{Memory allocation}} 
	\Rus{Расширение сегмента данных:}\Eng{Data segment extension:} 
   \begin{lstlisting}
int brk(void *endds); 
void *sbrk(intptr_t incr); \end{lstlisting}

	\vspace{0.4em} \Rus{Выделение новых сегментов из анонимной памяти:}\Eng{New segment allocation from an Anonymous Memory:}
   \begin{lstlisting}
void *mmap(
   void *addr,
   size_t len,
   int prot, 
   int flags,
   int fildes,
   off_t off
); \end{lstlisting}
\end{frame}

\iframe{\Rus{Утилита }pmap(1)\Eng{utility}} 
\lstinputlisting[language=C]{listings/sl52.c}
\end{frame}

\iframe{\Rus{Процесс}\Eng{Process}} 
	\Rus{Процесс -- это совокупность программы и метаинформации, описывающей её выполнение \textcopyright KorG}
	\Eng{A process is an aggregation of a program and a metadata describing the program's runtime \textcopyright KorG}

	\vspace{1em} \Rus{Выполняются параллельно и формально независимы друг от друга}\Eng{Run in parallel; technically independent from each other}
\end{frame}

\iframe{\Rus{Состояния процесса}\Eng{Process states}}
\begin{center}
	
	{\if\LANG3
		\includegraphics[width=0.99\textwidth]{img/process_states_ru.pdf}
		\fi }
	{\if\LANG2
		\includegraphics[width=0.99\textwidth]{img/process_states_en.pdf}
	\fi }
	
\end{center}      
\end{frame}

\input{slides/thanks} % благодарности
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usebackgroundtemplate{}
\begin{frame}[fragile]
   \vspace{3em}
   \centering \LARGE \Rus{Спасибо за внимание}\Eng{Thanks!}

   \vspace{4em}
   \begin{tabular}{c}
      \begin{lstlisting}[basicstyle=\tiny]
      # perl '-es!!),-#(-.?{<>-8#=..#<-*}>;*7-86)!;y!#()-?{}!\x20/`-v;<!;s++$_+ee'
      \end{lstlisting} 
   \end{tabular}
\end{frame}

\end{document}
